<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SwagChup - Ultimate PDF editing suite with a stylish interface. Edit, merge, convert, and manage PDFs with swag. Fast, secure, and 100% free.">
    <meta name="keywords" content="swagchup, swag pdf editor, pdf tools, merge pdf, convert pdf, edit pdf online, free pdf editor, stylish pdf tools">
    <title>SwagChup - PDF Tools with Style</title>
    
   <script src="https://quge5.com/88/tag.min.js" data-zone="212171" async data-cfasync="false"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3535670686155810"
     crossorigin="anonymous"></script>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PQNPPB23');</script>
    
    <!-- External Libraries (CDNs) -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pptxgenjs/3.12.0/pptxgen.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <style>
        :root {
            --primary-swag: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-dark: #5a67d8;
            --accent-swag: #ff6b6b;
            --accent-green: #38a169;
            --text-dark: #2d3748;
            --text-light: #718096;
            --border-color: #e2e8f0;
            --background-light: #f7fafc;
            --background-white: #ffffff;
            --shadow-swag: 0 10px 30px rgba(102, 126, 234, 0.2);
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            --header-height: 80px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body { 
            font-family: var(--font-family); 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-dark); 
            line-height: 1.6;
            min-height: 100vh;
        }

        /* --- Header --- */
        .main-header { 
            background: var(--background-white); 
            border-bottom: 1px solid var(--border-color); 
            height: var(--header-height); 
            position: sticky; 
            top: 0; 
            z-index: 1000; 
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }

        .nav-container { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            height: 100%; 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 0 30px; 
        }

        /* SwagChup Logo */
        .logo { 
            font-size: 2.2rem; 
            font-weight: 900; 
            background: var(--primary-swag);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none; 
            display: flex; 
            align-items: center; 
            gap: 12px;
            letter-spacing: -0.5px;
            position: relative;
        }

        .logo::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary-swag);
            border-radius: 2px;
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .logo:hover::after {
            transform: scaleX(1);
        }

        .swag-icon {
            width: 36px;
            height: 36px;
            background: var(--primary-swag);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transform: rotate(-5deg);
            box-shadow: var(--shadow-swag);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-10px) rotate(-5deg); }
        }

        .main-nav ul { 
            list-style: none; 
            display: flex; 
            gap: 40px; 
            align-items: center; 
        }

        .main-nav a { 
            text-decoration: none; 
            color: var(--text-dark); 
            font-weight: 600; 
            transition: all 0.3s ease;
            position: relative;
            padding: 5px 0;
        }

        .main-nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary-swag);
            transition: width 0.3s ease;
        }

        .main-nav a:hover::after {
            width: 100%;
        }

        .main-nav a:hover { 
            color: var(--primary-dark); 
        }

        /* Auth Buttons */
        .auth-buttons { display: flex; gap: 15px; }
        .btn-login, .btn-signup { 
            padding: 10px 25px; 
            border-radius: 8px; 
            font-weight: 600; 
            font-size: 0.95rem; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            border: 2px solid transparent;
        }

        .btn-login { 
            background: transparent; 
            color: var(--text-dark); 
            border-color: var(--border-color); 
        }

        .btn-login:hover { 
            border-color: var(--primary-dark); 
            color: var(--primary-dark); 
        }

        .btn-signup { 
            background: var(--primary-swag); 
            color: white; 
            border: none;
            box-shadow: var(--shadow-swag);
        }

        .btn-signup:hover { 
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.3);
        }

        /* User Profile */
        .user-profile { 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            cursor: pointer; 
            padding: 8px 15px; 
            border-radius: 10px; 
            transition: all 0.3s ease; 
            border: 2px solid transparent;
        }

        .user-profile:hover { 
            border-color: var(--border-color);
            background: rgba(102, 126, 234, 0.05);
        }

        .profile-avatar { 
            width: 40px; 
            height: 40px; 
            background: var(--primary-swag); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-weight: bold; 
            font-size: 1rem;
            box-shadow: var(--shadow-swag);
        }

        .hamburger { display: none; cursor: pointer; }
        .hamburger .bar { display: block; width: 25px; height: 3px; margin: 5px auto; background: var(--primary-swag); transition: all 0.3s ease; border-radius: 2px; }

        /* --- Hero Section --- */
        .hero-section { 
            text-align: center; 
            padding: 100px 20px 80px; 
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000" opacity="0.05"><path fill="%23667eea" d="M0,0L1000,0L1000,1000L0,1000Z"/></svg>');
            background-size: cover;
            z-index: -1;
        }

        .hero-section h1 { 
            font-size: 3.5rem; 
            margin-bottom: 1.5rem; 
            font-weight: 900;
            background: var(--primary-swag);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
        }

        .hero-section p { 
            font-size: 1.3rem; 
            color: var(--text-light); 
            max-width: 700px; 
            margin: 0 auto 40px;
            line-height: 1.8;
        }

        /* Stats Counter */
        .stats-container {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin-top: 60px;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 900;
            background: var(--primary-swag);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 10px;
        }

        /* --- Tools Grid --- */
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 40px; 
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 50px;
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 25%;
            width: 50%;
            height: 4px;
            background: var(--primary-swag);
            border-radius: 2px;
        }

        .tools-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
            gap: 30px; 
            margin-top: 40px;
        }

        .tool-card { 
            background: var(--background-white); 
            border: none; 
            border-radius: 15px; 
            padding: 30px; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.4s ease; 
            position: relative; 
            overflow: hidden;
            opacity: 0; 
            transform: translateY(30px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }

        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--primary-swag);
            transform: scaleX(0);
            transition: transform 0.4s ease;
        }

        .tool-card:hover::before {
            transform: scaleX(1);
        }

        .tool-card.reveal { animation: slideUp 0.6s forwards; }
        .tool-card:hover { 
            transform: translateY(-10px); 
            box-shadow: var(--shadow-swag); 
        }

        .tool-card .icon { 
            width: 70px; 
            height: 70px; 
            margin: 0 auto 20px auto; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 2.5em; 
            background: var(--primary-swag);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: transform 0.3s ease;
        }

        .tool-card:hover .icon {
            transform: scale(1.2) rotate(5deg);
        }

        .tool-card h3 { 
            font-size: 1.4rem; 
            margin-bottom: 10px; 
            color: var(--text-dark); 
        }

        .tool-card p { 
            font-size: 0.95rem; 
            color: var(--text-light); 
            margin-bottom: 20px;
        }

        .swag-badge { 
            position: absolute; 
            top: 15px; 
            right: 15px; 
            background: var(--accent-swag); 
            color: white; 
            padding: 5px 15px; 
            font-size: 0.75rem; 
            font-weight: 800; 
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .featured-badge {
            position: absolute;
            top: 15px;
            left: -25px;
            background: var(--accent-green);
            color: white;
            padding: 5px 30px;
            font-size: 0.75rem;
            font-weight: 800;
            transform: rotate(-45deg);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* --- Modal --- */
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background: rgba(0,0,0,0.7); 
            align-items: center; 
            justify-content: center; 
            backdrop-filter: blur(5px);
        }

        .modal.active { display: flex; }
        
        .modal-content-wrapper { 
            display: flex; 
            align-items: flex-start; 
            max-height: 90vh; 
            width: 90%;
            max-width: 1000px;
        }

        .modal-content { 
            background: var(--background-white); 
            padding: 40px; 
            border-radius: 20px; 
            width: 100%; 
            overflow-y: auto; 
            text-align: center; 
            position: relative; 
            animation: fadeIn 0.4s ease; 
            display: flex; 
            flex-direction: column; 
            max-height: 90vh;
            box-shadow: 0 30px 60px rgba(0,0,0,0.3);
        }

        .close-button { 
            position: absolute; 
            top: 20px; 
            right: 20px; 
            color: var(--text-light); 
            font-size: 30px; 
            font-weight: 300; 
            cursor: pointer; 
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-button:hover { 
            background: var(--background-light);
            color: var(--accent-swag);
            transform: rotate(90deg);
        }

        #drop-zone { 
            border: 3px dashed var(--border-color); 
            border-radius: 15px; 
            padding: 60px 40px; 
            margin-bottom: 30px; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            background: var(--background-light);
            position: relative;
        }

        #drop-zone::before {
            content: 'üìÅ';
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }

        #drop-zone.dragover { 
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%); 
            border-color: var(--primary-dark);
            transform: scale(1.02);
        }

        .select-file-btn { 
            background: var(--primary-swag); 
            color: white; 
            padding: 15px 40px; 
            border: none; 
            border-radius: 10px; 
            font-size: 1.1rem; 
            font-weight: bold; 
            cursor: pointer; 
            margin-top: 20px;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-swag);
        }

        .select-file-btn:hover { 
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.3);
        }

        #file-list { 
            list-style: none; 
            margin-top: 20px; 
            text-align: left; 
            max-height: 200px; 
            overflow-y: auto; 
            padding: 10px;
            background: var(--background-light);
            border-radius: 10px;
        }

        #file-list li { 
            background: white; 
            padding: 12px 20px; 
            border: 1px solid var(--border-color); 
            border-radius: 8px; 
            margin-bottom: 10px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            font-size: 0.95rem; 
            transition: all 0.3s ease;
        }

        #file-list li:hover {
            border-color: var(--primary-dark);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        #file-list span.remove { 
            color: var(--accent-swag); 
            cursor: pointer; 
            font-weight: bold; 
            padding: 5px 10px; 
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        #file-list span.remove:hover { 
            background: var(--accent-swag);
            color: white;
        }

        #tool-options { 
            margin: 30px 0; 
            text-align: left; 
            padding: 25px; 
            background: var(--background-light); 
            border-radius: 15px; 
            border: 2px solid var(--border-color); 
        }

        #tool-options label { 
            display: block; 
            margin-bottom: 10px; 
            font-weight: 700; 
            font-size: 0.95rem;
            color: var(--text-dark);
        }

        #tool-options input, #tool-options select { 
            width: 100%; 
            padding: 12px 15px; 
            border: 2px solid var(--border-color); 
            border-radius: 8px; 
            margin-bottom: 20px; 
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        #tool-options input:focus, #tool-options select:focus {
            outline: none;
            border-color: var(--primary-dark);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        #process-btn { 
            width: 100%; 
            background: var(--primary-swag); 
            color: white; 
            padding: 20px; 
            border: none; 
            border-radius: 12px; 
            font-size: 1.3rem; 
            font-weight: 800; 
            cursor: pointer; 
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: var(--shadow-swag);
        }

        #process-btn:hover:not(:disabled) { 
            transform: translateY(-3px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        #process-btn:disabled { 
            background: var(--border-color); 
            cursor: not-allowed; 
            box-shadow: none;
        }

        /* Output Area */
        #output-area {
            margin-top: 30px;
            padding: 20px;
            background: var(--background-light);
            border-radius: 15px;
            text-align: center;
        }

        .download-link {
            display: inline-block;
            background: var(--primary-swag);
            color: white;
            padding: 15px 40px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: bold;
            margin-top: 20px;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-swag);
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
        }

        .download-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.3);
        }

        /* --- Loader --- */
        .loader-container { 
            display: none; 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(255, 255, 255, 0.95); 
            z-index: 1001; 
            align-items: center; 
            justify-content: center; 
            flex-direction: column; 
            border-radius: 20px;
            backdrop-filter: blur(5px);
        }

        .loader-container.active { display: flex; }
        
        .loader { 
            border: 5px solid #f3f3f3; 
            border-top: 5px solid var(--primary-dark); 
            border-radius: 50%; 
            width: 60px; 
            height: 60px; 
            animation: spin 1s linear infinite; 
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.2);
        }

        @keyframes spin { 
            0% { transform: rotate(0deg); } 
            100% { transform: rotate(360deg); } 
        }

        @keyframes fadeIn { 
            from { opacity: 0; transform: scale(0.9); } 
            to { opacity: 1; transform: scale(1); } 
        }

        @keyframes slideUp { 
            from { opacity: 0; transform: translateY(30px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        /* --- Footer --- */
        .main-footer { 
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%); 
            color: #cbd5e0; 
            padding: 80px 0 30px; 
            margin-top: 100px; 
            position: relative;
        }

        .main-footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--primary-swag);
        }

        .footer-container { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 50px; 
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
        }

        .footer-col h4 { 
            color: white; 
            margin-bottom: 25px; 
            font-size: 1.3rem;
            position: relative;
            display: inline-block;
        }

        .footer-col h4::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 40px;
            height: 3px;
            background: var(--primary-swag);
            border-radius: 2px;
        }

        .footer-col ul { list-style: none; }
        .footer-col li { margin-bottom: 15px; }
        .footer-col a { 
            color: #cbd5e0; 
            text-decoration: none; 
            transition: all 0.3s ease;
            display: inline-block;
        }

        .footer-col a:hover { 
            color: white; 
            transform: translateX(5px);
        }

        .copyright { 
            text-align: center; 
            border-top: 1px solid #4a5568; 
            padding-top: 30px; 
            margin-top: 60px; 
            font-size: 0.9rem; 
            color: #a0aec0;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
            padding-left: 40px;
            padding-right: 40px;
        }

        /* --- Ad Containers --- */
        .ad-container { margin: 50px auto; text-align: center; }
        .ad-banner-top { width: 728px; height: 90px; max-width: 100%; margin: -30px auto 40px; }
        .ad-modal-sidebar { width: 200px; height: 400px; margin-left: 30px; flex-shrink: 0; border-radius: 15px; overflow: hidden; }
        .ad-between-tools { width: 100%; margin: 50px 0; }

        /* --- Responsive --- */
        @media (max-width: 1024px) {
            .hero-section h1 { font-size: 2.8rem; }
            .tools-grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); }
            .modal-content-wrapper { flex-direction: column; }
            .ad-modal-sidebar { display: none; }
        }

        @media (max-width: 768px) {
            .main-nav { 
                position: fixed; 
                left: -100%; 
                top: var(--header-height); 
                background: var(--background-white); 
                width: 100%; 
                height: calc(100vh - var(--header-height)); 
                text-align: center; 
                transition: 0.3s; 
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
                padding-top: 40px;
            }
            
            .main-nav.active { left: 0; }
            .main-nav ul { flex-direction: column; gap: 30px; }
            .auth-buttons { margin: 20px 0; }
            .hamburger { display: block; }
            .hamburger.active .bar:nth-child(2) { opacity: 0; }
            .hamburger.active .bar:nth-child(1) { transform: translateY(8px) rotate(45deg); }
            .hamburger.active .bar:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }
            
            .hero-section h1 { font-size: 2.2rem; }
            .hero-section p { font-size: 1.1rem; padding: 0 20px; }
            
            .section-title { font-size: 2rem; }
            .container { padding: 20px; }
            
            .stats-container { gap: 30px; }
            .stat-number { font-size: 2.2rem; }
            
            .modal-content { padding: 25px; }
            .modal-content-wrapper { width: 95%; }
            
            .footer-container { grid-template-columns: 1fr; gap: 40px; padding: 0 20px; }
        }

        @media (max-width: 480px) {
            .logo { font-size: 1.8rem; }
            .swag-icon { width: 30px; height: 30px; }
            .hero-section { padding: 60px 20px 40px; }
            .hero-section h1 { font-size: 1.8rem; }
            .tools-grid { grid-template-columns: 1fr; }
            .btn-login, .btn-signup { padding: 8px 20px; font-size: 0.9rem; }
        }
    </style>
</head>
<body>
    <!-- AMP Auto Ads Container -->
    <amp-auto-ads type="adsense"
        data-ad-client="ca-pub-3535670686155810">
    </amp-auto-ads>
    
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PQNPPB23"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <header class="main-header" id="main-header">
        <div class="nav-container">
            <a href="#" class="logo">
                <span class="swag-icon">S</span>
                SwagChup
            </a>
            <nav class="main-nav" id="main-nav">
                <ul>
                    <li><a href="https://omg10.com/4/10637159">Home</a></li>
                    <li><a href="#all-tools">Tools</a></li>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#pricing">Pricing</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
            <div class="hamburger" id="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </header>

    <section class="hero-section">
        <div class="container">
            <h1>PDF Tools with Ultimate Swag</h1>
            <p>Transform your PDF workflow with style. Merge, convert, edit, and manage documents effortlessly with our premium-grade tools. 100% free, secure, and packed with features.</p>
            
            <div class="stats-container">
                <div class="stat-item">
                    <div class="stat-number" data-count="25">0</div>
                    <div class="stat-label">Powerful Tools</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" data-count="100">0</div>
                    <div class="stat-label">% Free</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" data-count="1000">0</div>
                    <div class="stat-label">Files/Day</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" data-count="0">0</div>
                    <div class="stat-label">Uploads Required</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Top Banner Ad -->
    <div class="ad-container ad-banner-top">
        <!-- google ads swagchup -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-3535670686155810"
             data-ad-slot="3081571204"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <main class="container" id="all-tools">
        <h2 class="section-title">Featured Tools</h2>
        <div class="tools-grid" id="featured-tools">
            <!-- Featured tools will be injected here -->
        </div>
        
        <h2 class="section-title" style="margin-top: 80px;">All PDF Tools</h2>
        <div class="tools-grid" id="all-tools-grid">
            <!-- All tools will be injected here -->
        </div>
        
        <!-- Middle Banner Ad -->
        <div class="ad-container ad-between-tools">
            <!-- google ads swagchup -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-3535670686155810"
                 data-ad-slot="3081571204"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
    </main>

    <!-- Tool Modal -->
    <div id="tool-modal" class="modal">
        <div class="modal-content-wrapper">
            <div class="modal-content">
                <span class="close-button" id="close-modal">√ó</span>
                <h2 id="modal-title">Tool Title</h2>
                
                <div id="drop-zone">
                    <p>Drag & drop files here, or</p>
                    <button class="select-file-btn">Select Files</button>
                    <input type="file" id="file-input" style="display: none;" multiple>
                </div>

                <ul id="file-list"></ul>
                
                <div id="tool-options"></div>

                <button id="process-btn" disabled>Process with Swag</button>

                <div id="output-area"></div>

                <div class="loader-container">
                    <div class="loader"></div>
                    <p id="loader-text" style="margin-top:20px; font-weight:bold; color: var(--primary-dark);">Processing with style...</p>
                </div>
            </div>
            
            <!-- Modal Sidebar Ad -->
            <div class="ad-container ad-modal-sidebar">
                <!-- google ads swagchup -->
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-3535670686155810"
                     data-ad-slot="3081571204"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
        </div>
    </div>
    
    <footer class="main-footer" id="contact">
        <div class="footer-container">
            <div class="footer-col">
                <h4>SwagChup</h4>
                <p>Redefining PDF editing with style, speed, and security. All processing happens in your browser - your files never leave your computer.</p>
            </div>
            <div class="footer-col">
                <h4>Top Tools</h4>
                <ul>
                    <li><a href="#all-tools">Merge PDF</a></li>
                    <li><a href="#all-tools">Split PDF</a></li>
                    <li><a href="#all-tools">Compress PDF</a></li>
                    <li><a href="#all-tools">Edit PDF</a></li>
                    <li><a href="#all-tools">Convert PDF</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Company</h4>
                <ul>
                    <li><a href='https://omg10.com/4/10623166'>About Us</a></li>
                    <li><a href='#'>Privacy Policy</a></li>
                    <li><a href='#'>Terms of Service</a></li>
                    <li><a href='#'>Blog</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Connect</h4>
                <ul>
                    <li><a href="mailto:hello@swagchup.com">hello@swagchup.com</a></li>
                    <li><a href="#">Twitter</a></li>
                    <li><a href="#">LinkedIn</a></li>
                    <li><a href="#">GitHub</a></li>
                </ul>
            </div>
        </div>
        
        <!-- Footer Ad -->
        <div class="ad-container ad-between-tools">
            <!-- google ads swagchup -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-3535670686155810"
                 data-ad-slot="3081571204"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
        
        <div class="copyright">
            <p>¬© 2024 SwagChup. All Rights Reserved. Made with ‚ù§Ô∏è and lots of swag.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- Configuration & Utilities ---
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';
            const { PDFDocument, rgb, degrees, StandardFonts } = PDFLib;

            const state = {
                currentToolId: null,
                files: [],
                pdfDoc: null
            };

            const utils = {
                showLoader: (text = 'Processing with style...') => {
                    document.getElementById('loader-text').innerText = text;
                    document.querySelector('.loader-container').classList.add('active');
                },
                hideLoader: () => {
                    document.querySelector('.loader-container').classList.remove('active');
                },
                showError: (msg) => {
                    utils.hideLoader();
                    alert(msg);
                },
                createDownloadLink: (blob, filename) => {
                    const url = URL.createObjectURL(blob);
                    const outputDiv = document.getElementById('output-area');
                    outputDiv.innerHTML = '';
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    a.className = 'download-link';
                    a.innerText = `Download ${filename}`;
                    outputDiv.appendChild(a);
                    
                    // Also create a direct download
                    setTimeout(() => {
                        a.click();
                    }, 100);
                },
                readFileAsArrayBuffer: (file) => {
                    return new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = () => resolve(reader.result);
                        reader.onerror = reject;
                        reader.readAsArrayBuffer(file);
                    });
                },
                readFileAsDataURL: (file) => {
                    return new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = () => resolve(reader.result);
                        reader.onerror = reject;
                        reader.readAsDataURL(file);
                    });
                },
                validatePassword: (password) => {
                    return password && password.length >= 4;
                }
            };

            // --- All Tool Implementations ---
            const tools = {
                'merge-pdf': {
                    title: 'Merge PDF',
                    desc: 'Combine multiple PDFs into one unified document.',
                    icon: 'üìë',
                    accept: '.pdf',
                    multiple: true,
                    featured: true,
                    process: async (files) => {
                        utils.showLoader('Merging PDFs with swag...');
                        try {
                            const mergedPdf = await PDFDocument.create();
                            for (const file of files) {
                                const bytes = await utils.readFileAsArrayBuffer(file);
                                const pdf = await PDFDocument.load(bytes);
                                const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                                copiedPages.forEach((page) => mergedPdf.addPage(page));
                            }
                            const pdfBytes = await mergedPdf.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'merged_swag.pdf');
                        } catch (error) {
                            utils.showError('Error merging PDFs: ' + error.message);
                        }
                        utils.hideLoader();
                    }
                },
                'split-pdf': {
                    title: 'Split PDF',
                    desc: 'Extract specific pages or ranges from PDF.',
                    icon: '‚úÇÔ∏è',
                    accept: '.pdf',
                    multiple: false,
                    featured: true,
                    optionsUI: `<label>Page Ranges (e.g., "1-3, 5, 7-9"):</label>
                               <input type="text" id="split-range" placeholder="e.g. 1, 3-5, 7-10">
                               <small style="color: var(--text-light);">Separate pages/ranges with commas</small>`,
                    process: async (files) => {
                        const rangeStr = document.getElementById('split-range').value;
                        if (!rangeStr) return utils.showError('Please enter page ranges.');
                        
                        utils.showLoader('Splitting PDF...');
                        try {
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            const pdfDoc = await PDFDocument.load(bytes);
                            const newPdf = await PDFDocument.create();
                            const totalPages = pdfDoc.getPageCount();
                            
                            const pagesToCopy = new Set();
                            rangeStr.split(',').forEach(part => {
                                const range = part.trim().split('-');
                                if(range.length === 2) {
                                    const start = parseInt(range[0]);
                                    const end = parseInt(range[1]);
                                    if(!isNaN(start) && !isNaN(end)) {
                                        for(let i = start; i <= end; i++) pagesToCopy.add(i-1);
                                    }
                                } else {
                                    const page = parseInt(range[0]);
                                    if(!isNaN(page)) pagesToCopy.add(page-1);
                                }
                            });

                            const indices = Array.from(pagesToCopy).filter(i => i >= 0 && i < totalPages);
                            if(indices.length === 0) return utils.showError('Invalid page range.');

                            const copiedPages = await newPdf.copyPages(pdfDoc, indices);
                            copiedPages.forEach(page => newPdf.addPage(page));
                            
                            const pdfBytes = await newPdf.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'split_swag.pdf');
                        } catch (error) {
                            utils.showError('Error splitting PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    }
                },
                'compress-pdf': {
                    title: 'Compress PDF',
                    desc: 'Reduce file size while maintaining quality.',
                    icon: 'üóúÔ∏è',
                    accept: '.pdf',
                    multiple: false,
                    featured: true,
                    optionsUI: `<label>Compression Level:</label>
                               <select id="comp-level">
                                   <option value="high">High Compression (Smallest)</option>
                                   <option value="medium" selected>Recommended</option>
                                   <option value="low">Light Compression (Best Quality)</option>
                               </select>`,
                    process: async (files) => {
                        utils.showLoader('Compressing PDF...');
                        try {
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            const pdfDoc = await PDFDocument.load(bytes);
                            
                            // Simulate compression by saving with different options
                            const saveOptions = {
                                useObjectStreams: true,
                                addDefaultPage: false
                            };
                            
                            const pdfBytes = await pdfDoc.save(saveOptions);
                            const originalSize = files[0].size;
                            const compressedSize = pdfBytes.byteLength;
                            const reduction = ((originalSize - compressedSize) / originalSize * 100).toFixed(1);
                            
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'compressed_swag.pdf');
                            
                            // Show compression info
                            setTimeout(() => {
                                const outputDiv = document.getElementById('output-area');
                                const info = document.createElement('p');
                                info.innerHTML = `Compressed by <strong>${reduction}%</strong> (${(originalSize/1024).toFixed(1)}KB ‚Üí ${(compressedSize/1024).toFixed(1)}KB)`;
                                info.style.marginTop = '10px';
                                info.style.color = 'var(--accent-green)';
                                outputDiv.appendChild(info);
                            }, 100);
                            
                        } catch (error) {
                            utils.showError('Error compressing PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    }
                },
                'pdf-to-word': {
                    title: 'PDF to Word',
                    desc: 'Convert PDF to editable Word document.',
                    icon: 'üìù',
                    accept: '.pdf',
                    multiple: false,
                    process: async (files) => {
                        utils.showLoader('Extracting text from PDF...');
                        try {
                            const data = await utils.readFileAsArrayBuffer(files[0]);
                            const pdf = await pdfjsLib.getDocument({data}).promise;
                            let text = "";
                            
                            for(let i = 1; i <= pdf.numPages; i++){
                                const page = await pdf.getPage(i);
                                const content = await page.getTextContent();
                                const strings = content.items.map(item => item.str);
                                text += strings.join(" ") + "\n\n";
                            }
                            
                            // Create a simple Word-like document
                            const htmlContent = `
                                <!DOCTYPE html>
                                <html>
                                <head>
                                    <meta charset="UTF-8">
                                    <title>Converted Document</title>
                                    <style>
                                        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 40px; }
                                        .page-break { page-break-after: always; }
                                    </style>
                                </head>
                                <body>
                                    <h1>Converted PDF Document</h1>
                                    <p>${text.replace(/\n/g, '</p><p>')}</p>
                                </body>
                                </html>
                            `;
                            
                            const blob = new Blob([htmlContent], { type: 'text/html' });
                            utils.createDownloadLink(blob, 'converted_document.html');
                            
                        } catch (error) {
                            utils.showError('Error converting PDF to Word: ' + error.message);
                        }
                        utils.hideLoader();
                    }
                },
                'word-to-pdf': {
                    title: 'Word to PDF',
                    desc: 'Convert Word documents to PDF format.',
                    icon: 'üìÑ',
                    accept: '.doc,.docx,.txt,.rtf',
                    multiple: false,
                    process: async (files) => {
                        utils.showLoader('Converting to PDF...');
                        try {
                            const file = files[0];
                            const text = await new Promise((resolve, reject) => {
                                const reader = new FileReader();
                                reader.onload = (e) => resolve(e.target.result);
                                reader.onerror = reject;
                                reader.readAsText(file);
                            });
                            
                            // Create PDF from text
                            const pdfDoc = await PDFDocument.create();
                            const page = pdfDoc.addPage([600, 800]);
                            const font = await pdfDoc.embedFont(StandardFonts.Helvetica);
                            
                            // Simple text wrapping
                            const lines = text.split('\n');
                            let y = 750;
                            const lineHeight = 20;
                            
                            for (const line of lines) {
                                if (y < 50) {
                                    pdfDoc.addPage([600, 800]);
                                    y = 750;
                                }
                                
                                const words = line.split(' ');
                                let currentLine = '';
                                
                                for (const word of words) {
                                    const testLine = currentLine + word + ' ';
                                    const width = font.widthOfTextAtSize(testLine, 12);
                                    
                                    if (width < 550 || currentLine === '') {
                                        currentLine = testLine;
                                    } else {
                                        page.drawText(currentLine, {
                                            x: 50,
                                            y: y,
                                            size: 12,
                                            font: font,
                                            color: rgb(0, 0, 0)
                                        });
                                        y -= lineHeight;
                                        currentLine = word + ' ';
                                    }
                                }
                                
                                if (currentLine) {
                                    page.drawText(currentLine, {
                                        x: 50,
                                        y: y,
                                        size: 12,
                                        font: font,
                                        color: rgb(0, 0, 0)
                                    });
                                    y -= lineHeight;
                                }
                            }
                            
                            const pdfBytes = await pdfDoc.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'converted_swag.pdf');
                            
                        } catch (error) {
                            utils.showError('Error converting to PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    }
                },
                'pdf-to-powerpoint': {
                    title: 'PDF to PowerPoint',
                    desc: 'Convert PDF pages to PowerPoint slides.',
                    icon: 'üìä',
                    accept: '.pdf',
                    multiple: false,
                    process: async (files) => {
                        utils.showLoader('Creating PowerPoint presentation...');
                        try {
                            const data = await utils.readFileAsArrayBuffer(files[0]);
                            const pdf = await pdfjsLib.getDocument({data}).promise;
                            const pptx = new PptxGenJS();
                            
                            for(let i = 1; i <= pdf.numPages; i++){
                                utils.showLoader(`Processing page ${i}/${pdf.numPages}`);
                                const page = await pdf.getPage(i);
                                const viewport = page.getViewport({scale: 0.5});
                                const canvas = document.createElement('canvas');
                                const context = canvas.getContext('2d');
                                canvas.height = viewport.height;
                                canvas.width = viewport.width;
                                
                                await page.render({canvasContext: context, viewport: viewport}).promise;
                                const imgData = canvas.toDataURL('image/png');
                                
                                const slide = pptx.addSlide();
                                slide.addImage({ 
                                    data: imgData, 
                                    x: 0.5, 
                                    y: 0.5, 
                                    w: '90%', 
                                    h: '90%' 
                                });
                                slide.addText(`Slide ${i}`, { x: 0.5, y: 0.1, fontSize: 14, color: '363636' });
                            }
                            
                            pptx.writeFile({ fileName: "presentation_swag.pptx" });
                            document.getElementById('output-area').innerHTML = "<p style='color: var(--accent-green); font-weight: bold;'>Download started automatically!</p>";
                            
                        } catch (error) {
                            utils.showError('Error creating PowerPoint: ' + error.message);
                        }
                        utils.hideLoader();
                    }
                },
                'edit-pdf': {
                    title: 'Edit PDF',
                    desc: 'Add text, shapes and annotations to PDF.',
                    icon: '‚úèÔ∏è',
                    accept: '.pdf',
                    multiple: false,
                    featured: true,
                    optionsUI: `
                        <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                            <button id="add-text-btn" style="padding: 10px 20px; background: var(--primary-swag); color: white; border: none; border-radius: 8px; cursor: pointer;">Add Text</button>
                            <button id="add-rect-btn" style="padding: 10px 20px; background: var(--accent-swag); color: white; border: none; border-radius: 8px; cursor: pointer;">Add Box</button>
                            <input type="color" id="edit-color" value="#667eea" style="padding: 5px; border-radius: 8px; border: 2px solid var(--border-color);">
                            <select id="font-size" style="padding: 8px; border-radius: 8px; border: 2px solid var(--border-color);">
                                <option value="12">Small</option>
                                <option value="16" selected>Medium</option>
                                <option value="24">Large</option>
                                <option value="32">X-Large</option>
                            </select>
                        </div>
                        <div id="canvas-container" style="border: 2px solid var(--border-color); border-radius: 10px; overflow: auto; max-height: 400px; background: white; min-height: 300px;">
                            <canvas id="edit-canvas"></canvas>
                        </div>
                        <div style="margin-top: 10px; color: var(--text-light); font-size: 0.9rem; font-style: italic;">
                            Click to add elements. Drag to move. Double-click to edit text.
                        </div>
                    `,
                    process: async (files) => {
                        utils.showLoader('Applying edits...');
                        try {
                            const canvas = window.fabricCanvas;
                            const dataURL = canvas.toDataURL({format: 'png'});
                            
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            const pdfDoc = await PDFDocument.load(bytes);
                            const page = pdfDoc.getPages()[0];
                            
                            const pngImage = await pdfDoc.embedPng(dataURL);
                            const { width, height } = page.getSize();
                            
                            page.drawImage(pngImage, {
                                x: 0,
                                y: 0,
                                width: width,
                                height: height,
                            });
                            
                            const pdfBytes = await pdfDoc.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'edited_swag.pdf');
                            
                        } catch (error) {
                            utils.showError('Error editing PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    },
                    onFileSelect: async (file) => {
                        utils.showLoader('Loading editor...');
                        try {
                            const data = await utils.readFileAsArrayBuffer(file);
                            const pdf = await pdfjsLib.getDocument({data}).promise;
                            const page = await pdf.getPage(1);
                            const viewport = page.getViewport({scale: 1.0});
                            
                            const canvasEl = document.getElementById('edit-canvas');
                            canvasEl.width = viewport.width;
                            canvasEl.height = viewport.height;
                            
                            const context = canvasEl.getContext('2d');
                            await page.render({canvasContext: context, viewport: viewport}).promise;
                            
                            const bgImage = canvasEl.toDataURL();
                            if(window.fabricCanvas) window.fabricCanvas.dispose();
                            const fCanvas = new fabric.Canvas('edit-canvas');
                            window.fabricCanvas = fCanvas;
                            
                            fCanvas.setBackgroundImage(bgImage, fCanvas.renderAll.bind(fCanvas));
                            fCanvas.setWidth(viewport.width);
                            fCanvas.setHeight(viewport.height);
                            fCanvas.renderAll();

                            document.getElementById('add-text-btn').onclick = () => {
                                fCanvas.add(new fabric.IText('Edit me', { 
                                    left: 50, 
                                    top: 50, 
                                    fill: document.getElementById('edit-color').value,
                                    fontSize: parseInt(document.getElementById('font-size').value),
                                    fontFamily: 'Arial'
                                }));
                            };
                            
                            document.getElementById('add-rect-btn').onclick = () => {
                                fCanvas.add(new fabric.Rect({ 
                                    left: 100, 
                                    top: 100, 
                                    width: 100, 
                                    height: 60, 
                                    fill: 'transparent', 
                                    stroke: document.getElementById('edit-color').value, 
                                    strokeWidth: 2 
                                }));
                            };
                            
                        } catch (error) {
                            utils.showError('Error loading PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    }
                },
                'sign-pdf': {
                    title: 'Sign PDF',
                    desc: 'Add digital signatures to your PDF.',
                    icon: '‚úçÔ∏è',
                    accept: '.pdf',
                    multiple: false,
                    optionsUI: `
                        <div style="margin-bottom: 20px;">
                            <p>Draw your signature below:</p>
                            <canvas id="sig-canvas" width="400" height="200" style="border: 2px solid var(--border-color); border-radius: 8px; cursor: crosshair;"></canvas>
                            <div style="margin-top: 10px;">
                                <button id="clear-sig" style="padding: 8px 20px; background: var(--accent-swag); color: white; border: none; border-radius: 6px; cursor: pointer; margin-right: 10px;">Clear</button>
                                <button id="save-sig" style="padding: 8px 20px; background: var(--accent-green); color: white; border: none; border-radius: 6px; cursor: pointer;">Save Signature</button>
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <label>Signature Position:</label>
                            <select id="sig-position">
                                <option value="bottom-right">Bottom Right</option>
                                <option value="bottom-left">Bottom Left</option>
                                <option value="top-right">Top Right</option>
                                <option value="top-left">Top Left</option>
                                <option value="center">Center</option>
                            </select>
                        </div>
                    `,
                    process: async (files) => {
                        utils.showLoader('Adding signature...');
                        try {
                            const canvas = document.getElementById('sig-canvas');
                            const sigData = canvas.toDataURL('image/png');
                            
                            // Check if signature is drawn
                            const ctx = canvas.getContext('2d');
                            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                            const hasSignature = imageData.data.some(channel => channel !== 0);
                            
                            if (!hasSignature) {
                                utils.showError('Please draw your signature first!');
                                utils.hideLoader();
                                return;
                            }
                            
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            const pdfDoc = await PDFDocument.load(bytes);
                            const pngImage = await pdfDoc.embedPng(sigData);
                            const page = pdfDoc.getPages()[0];
                            const { width, height } = page.getSize();
                            
                            const position = document.getElementById('sig-position').value;
                            let x, y;
                            
                            switch(position) {
                                case 'bottom-right': x = width - 150; y = 50; break;
                                case 'bottom-left': x = 50; y = 50; break;
                                case 'top-right': x = width - 150; y = height - 100; break;
                                case 'top-left': x = 50; y = height - 100; break;
                                case 'center': x = width/2 - 75; y = height/2 - 50; break;
                                default: x = width - 150; y = 50;
                            }
                            
                            page.drawImage(pngImage, {
                                x: x,
                                y: y,
                                width: 150,
                                height: 75,
                                opacity: 0.8
                            });
                            
                            const pdfBytes = await pdfDoc.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'signed_swag.pdf');
                            
                        } catch (error) {
                            utils.showError('Error signing PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    },
                    onFileSelect: () => {
                        const canvas = document.getElementById('sig-canvas');
                        const ctx = canvas.getContext('2d');
                        let isDrawing = false;
                        let lastX = 0;
                        let lastY = 0;
                        
                        // Clear canvas
                        ctx.fillStyle = 'white';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        ctx.strokeStyle = '#000000';
                        ctx.lineWidth = 2;
                        ctx.lineCap = 'round';
                        ctx.lineJoin = 'round';
                        
                        function draw(e) {
                            if (!isDrawing) return;
                            ctx.beginPath();
                            ctx.moveTo(lastX, lastY);
                            ctx.lineTo(e.offsetX, e.offsetY);
                            ctx.stroke();
                            [lastX, lastY] = [e.offsetX, e.offsetY];
                        }
                        
                        canvas.addEventListener('mousedown', (e) => {
                            isDrawing = true;
                            [lastX, lastY] = [e.offsetX, e.offsetY];
                        });
                        
                        canvas.addEventListener('mousemove', draw);
                        canvas.addEventListener('mouseup', () => isDrawing = false);
                        canvas.addEventListener('mouseout', () => isDrawing = false);
                        
                        // Touch support
                        canvas.addEventListener('touchstart', (e) => {
                            e.preventDefault();
                            const touch = e.touches[0];
                            const rect = canvas.getBoundingClientRect();
                            isDrawing = true;
                            [lastX, lastY] = [touch.clientX - rect.left, touch.clientY - rect.top];
                        });
                        
                        canvas.addEventListener('touchmove', (e) => {
                            e.preventDefault();
                            if (!isDrawing) return;
                            const touch = e.touches[0];
                            const rect = canvas.getBoundingClientRect();
                            const x = touch.clientX - rect.left;
                            const y = touch.clientY - rect.top;
                            
                            ctx.beginPath();
                            ctx.moveTo(lastX, lastY);
                            ctx.lineTo(x, y);
                            ctx.stroke();
                            [lastX, lastY] = [x, y];
                        });
                        
                        canvas.addEventListener('touchend', () => isDrawing = false);
                        
                        document.getElementById('clear-sig').onclick = () => {
                            ctx.fillStyle = 'white';
                            ctx.fillRect(0, 0, canvas.width, canvas.height);
                        };
                        
                        document.getElementById('save-sig').onclick = () => {
                            localStorage.setItem('savedSignature', canvas.toDataURL());
                            alert('Signature saved!');
                        };
                        
                        // Load saved signature if exists
                        const savedSig = localStorage.getItem('savedSignature');
                        if (savedSig) {
                            const img = new Image();
                            img.onload = () => {
                                ctx.drawImage(img, 0, 0);
                            };
                            img.src = savedSig;
                        }
                    }
                },
                'watermark-pdf': {
                    title: 'Watermark PDF',
                    desc: 'Add text or image watermarks to PDF.',
                    icon: 'üíß',
                    accept: '.pdf',
                    multiple: false,
                    optionsUI: `
                        <label>Watermark Text:</label>
                        <input type="text" id="wm-text" value="CONFIDENTIAL" placeholder="Enter watermark text">
                        
                        <label>Text Color:</label>
                        <input type="color" id="wm-color" value="#999999">
                        
                        <label>Opacity:</label>
                        <input type="range" id="wm-opacity" min="0.1" max="1" step="0.1" value="0.3">
                        <span id="opacity-value">30%</span>
                        
                        <label>Rotation:</label>
                        <select id="wm-rotation">
                            <option value="45">45¬∞ Diagonal</option>
                            <option value="0">Horizontal</option>
                            <option value="90">Vertical</option>
                            <option value="-45">-45¬∞ Diagonal</option>
                        </select>
                        
                        <label>Position:</label>
                        <select id="wm-position">
                            <option value="center">Center</option>
                            <option value="tiled">Tiled (All over)</option>
                            <option value="top-left">Top Left</option>
                            <option value="top-right">Top Right</option>
                            <option value="bottom-left">Bottom Left</option>
                            <option value="bottom-right">Bottom Right</option>
                        </select>
                    `,
                    process: async (files) => {
                        utils.showLoader('Adding watermark...');
                        try {
                            const text = document.getElementById('wm-text').value || 'CONFIDENTIAL';
                            const color = document.getElementById('wm-color').value;
                            const opacity = parseFloat(document.getElementById('wm-opacity').value);
                            const rotation = parseInt(document.getElementById('wm-rotation').value);
                            const position = document.getElementById('wm-position').value;
                            
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            const pdfDoc = await PDFDocument.load(bytes);
                            const font = await pdfDoc.embedFont(StandardFonts.HelveticaBold);
                            
                            const pages = pdfDoc.getPages();
                            const colorRGB = hexToRgb(color);
                            
                            for (const page of pages) {
                                const { width, height } = page.getSize();
                                
                                if (position === 'tiled') {
                                    // Tile watermarks across the page
                                    const watermarkSize = 40;
                                    const spacing = 150;
                                    
                                    for (let x = 50; x < width - 100; x += spacing) {
                                        for (let y = 50; y < height - 100; y += spacing) {
                                            page.drawText(text, {
                                                x: x,
                                                y: y,
                                                size: watermarkSize,
                                                font: font,
                                                color: rgb(colorRGB.r, colorRGB.g, colorRGB.b),
                                                opacity: opacity,
                                                rotate: degrees(rotation),
                                            });
                                        }
                                    }
                                } else {
                                    let x, y;
                                    const watermarkSize = 60;
                                    
                                    switch(position) {
                                        case 'center': x = width/2 - 150; y = height/2; break;
                                        case 'top-left': x = 50; y = height - 100; break;
                                        case 'top-right': x = width - 300; y = height - 100; break;
                                        case 'bottom-left': x = 50; y = 100; break;
                                        case 'bottom-right': x = width - 300; y = 100; break;
                                        default: x = width/2 - 150; y = height/2;
                                    }
                                    
                                    page.drawText(text, {
                                        x: x,
                                        y: y,
                                        size: watermarkSize,
                                        font: font,
                                        color: rgb(colorRGB.r, colorRGB.g, colorRGB.b),
                                        opacity: opacity,
                                        rotate: degrees(rotation),
                                    });
                                }
                            }
                            
                            const pdfBytes = await pdfDoc.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'watermarked_swag.pdf');
                            
                        } catch (error) {
                            utils.showError('Error adding watermark: ' + error.message);
                        }
                        utils.hideLoader();
                    },
                    onFileSelect: () => {
                        const opacitySlider = document.getElementById('wm-opacity');
                        const opacityValue = document.getElementById('opacity-value');
                        
                        opacitySlider.addEventListener('input', () => {
                            const value = Math.round(opacitySlider.value * 100);
                            opacityValue.textContent = `${value}%`;
                        });
                    }
                },
                'rotate-pdf': {
                    title: 'Rotate PDF',
                    desc: 'Rotate PDF pages to correct orientation.',
                    icon: 'üîÑ',
                    accept: '.pdf',
                    multiple: false,
                    optionsUI: `
                        <label>Rotation Direction:</label>
                        <select id="rot-direction">
                            <option value="90">90¬∞ Clockwise</option>
                            <option value="-90">90¬∞ Counter-clockwise</option>
                            <option value="180">180¬∞ Flip</option>
                        </select>
                        
                        <label style="margin-top: 15px;">Apply to:</label>
                        <select id="rot-pages">
                            <option value="all">All Pages</option>
                            <option value="odd">Odd Pages Only</option>
                            <option value="even">Even Pages Only</option>
                            <option value="range">Specific Pages</option>
                        </select>
                        
                        <div id="page-range-container" style="display: none; margin-top: 10px;">
                            <label>Page Range (e.g., "1-3, 5"):</label>
                            <input type="text" id="rot-range" placeholder="e.g. 1-3, 5">
                        </div>
                    `,
                    process: async (files) => {
                        utils.showLoader('Rotating PDF...');
                        try {
                            const direction = parseInt(document.getElementById('rot-direction').value);
                            const pagesOption = document.getElementById('rot-pages').value;
                            const rangeStr = document.getElementById('rot-range').value;
                            
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            const pdfDoc = await PDFDocument.load(bytes);
                            const pageCount = pdfDoc.getPages().length;
                            
                            let pagesToRotate = [];
                            
                            if (pagesOption === 'all') {
                                pagesToRotate = Array.from({length: pageCount}, (_, i) => i);
                            } else if (pagesOption === 'odd') {
                                pagesToRotate = Array.from({length: pageCount}, (_, i) => i).filter(i => i % 2 === 0);
                            } else if (pagesOption === 'even') {
                                pagesToRotate = Array.from({length: pageCount}, (_, i) => i).filter(i => i % 2 === 1);
                            } else if (pagesOption === 'range' && rangeStr) {
                                const pagesSet = new Set();
                                rangeStr.split(',').forEach(part => {
                                    const range = part.trim().split('-');
                                    if(range.length === 2) {
                                        const start = parseInt(range[0]);
                                        const end = parseInt(range[1]);
                                        if(!isNaN(start) && !isNaN(end)) {
                                            for(let i = start; i <= end; i++) pagesSet.add(i-1);
                                        }
                                    } else {
                                        const page = parseInt(range[0]);
                                        if(!isNaN(page)) pagesSet.add(page-1);
                                    }
                                });
                                pagesToRotate = Array.from(pagesSet).filter(i => i >= 0 && i < pageCount);
                            }
                            
                            pagesToRotate.forEach(pageIndex => {
                                const page = pdfDoc.getPages()[pageIndex];
                                const currentRotation = page.getRotation().angle;
                                page.setRotation(degrees(currentRotation + direction));
                            });
                            
                            const pdfBytes = await pdfDoc.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'rotated_swag.pdf');
                            
                        } catch (error) {
                            utils.showError('Error rotating PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    },
                    onFileSelect: () => {
                        const pagesSelect = document.getElementById('rot-pages');
                        const rangeContainer = document.getElementById('page-range-container');
                        
                        pagesSelect.addEventListener('change', () => {
                            rangeContainer.style.display = pagesSelect.value === 'range' ? 'block' : 'none';
                        });
                    }
                },
                'jpg-to-pdf': {
                    title: 'JPG to PDF',
                    desc: 'Convert JPG/PNG images to PDF.',
                    icon: 'üñºÔ∏è',
                    accept: '.jpg,.jpeg,.png,.gif,.bmp',
                    multiple: true,
                    process: async (files) => {
                        utils.showLoader('Creating PDF from images...');
                        try {
                            const pdfDoc = await PDFDocument.create();
                            
                            for (const file of files) {
                                const bytes = await utils.readFileAsArrayBuffer(file);
                                let image;
                                
                                if (file.type.includes('jpeg') || file.type.includes('jpg')) {
                                    image = await pdfDoc.embedJpg(bytes);
                                } else {
                                    image = await pdfDoc.embedPng(bytes);
                                }
                                
                                const page = pdfDoc.addPage([image.width, image.height]);
                                page.drawImage(image, {
                                    x: 0,
                                    y: 0,
                                    width: image.width,
                                    height: image.height,
                                });
                            }
                            
                            const pdfBytes = await pdfDoc.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'images_swag.pdf');
                            
                        } catch (error) {
                            utils.showError('Error creating PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    }
                },
                'pdf-to-jpg': {
                    title: 'PDF to JPG',
                    desc: 'Convert PDF pages to JPG images.',
                    icon: 'üì∏',
                    accept: '.pdf',
                    multiple: false,
                    optionsUI: `
                        <label>Image Format:</label>
                        <select id="img-format">
                            <option value="jpg">JPG</option>
                            <option value="png">PNG</option>
                        </select>
                        
                        <label>Image Quality (JPG only):</label>
                        <input type="range" id="img-quality" min="0.1" max="1" step="0.1" value="0.8">
                        <span id="quality-value">80%</span>
                        
                        <label>Pages to Convert:</label>
                        <select id="img-pages">
                            <option value="all">All Pages</option>
                            <option value="first">First Page Only</option>
                            <option value="range">Specific Pages</option>
                        </select>
                        
                        <div id="img-range-container" style="display: none; margin-top: 10px;">
                            <label>Page Numbers (comma separated):</label>
                            <input type="text" id="img-range" placeholder="e.g. 1, 3, 5">
                        </div>
                    `,
                    process: async (files) => {
                        utils.showLoader('Converting PDF to images...');
                        try {
                            const format = document.getElementById('img-format').value;
                            const quality = parseFloat(document.getElementById('img-quality').value);
                            const pagesOption = document.getElementById('img-pages').value;
                            const rangeStr = document.getElementById('img-range').value;
                            
                            const data = await utils.readFileAsArrayBuffer(files[0]);
                            const pdf = await pdfjsLib.getDocument({data}).promise;
                            const totalPages = pdf.numPages;
                            
                            let pagesToConvert = [];
                            
                            if (pagesOption === 'all') {
                                pagesToConvert = Array.from({length: totalPages}, (_, i) => i + 1);
                            } else if (pagesOption === 'first') {
                                pagesToConvert = [1];
                            } else if (pagesOption === 'range' && rangeStr) {
                                pagesToConvert = rangeStr.split(',').map(p => parseInt(p.trim())).filter(p => !isNaN(p) && p >= 1 && p <= totalPages);
                            }
                            
                            if (pagesToConvert.length === 0) {
                                utils.showError('No valid pages selected for conversion.');
                                utils.hideLoader();
                                return;
                            }
                            
                            const zip = new JSZip();
                            
                            for (const pageNum of pagesToConvert) {
                                utils.showLoader(`Converting page ${pageNum}/${pagesToConvert.length}`);
                                const page = await pdf.getPage(pageNum);
                                const viewport = page.getViewport({scale: 2.0});
                                const canvas = document.createElement('canvas');
                                const context = canvas.getContext('2d');
                                canvas.height = viewport.height;
                                canvas.width = viewport.width;
                                
                                await page.render({canvasContext: context, viewport: viewport}).promise;
                                
                                let imageData;
                                if (format === 'jpg') {
                                    imageData = canvas.toDataURL('image/jpeg', quality);
                                } else {
                                    imageData = canvas.toDataURL('image/png');
                                }
                                
                                // Convert data URL to blob
                                const byteString = atob(imageData.split(',')[1]);
                                const mimeString = imageData.split(',')[0].split(':')[1].split(';')[0];
                                const ab = new ArrayBuffer(byteString.length);
                                const ia = new Uint8Array(ab);
                                for (let i = 0; i < byteString.length; i++) {
                                    ia[i] = byteString.charCodeAt(i);
                                }
                                const blob = new Blob([ab], {type: mimeString});
                                
                                zip.file(`page_${pageNum}.${format}`, blob);
                            }
                            
                            const zipBlob = await zip.generateAsync({type: 'blob'});
                            utils.createDownloadLink(zipBlob, `converted_images.zip`);
                            
                        } catch (error) {
                            utils.showError('Error converting PDF to images: ' + error.message);
                        }
                        utils.hideLoader();
                    },
                    onFileSelect: () => {
                        const qualitySlider = document.getElementById('img-quality');
                        const qualityValue = document.getElementById('quality-value');
                        const pagesSelect = document.getElementById('img-pages');
                        const rangeContainer = document.getElementById('img-range-container');
                        
                        qualitySlider.addEventListener('input', () => {
                            const value = Math.round(qualitySlider.value * 100);
                            qualityValue.textContent = `${value}%`;
                        });
                        
                        pagesSelect.addEventListener('change', () => {
                            rangeContainer.style.display = pagesSelect.value === 'range' ? 'block' : 'none';
                        });
                    }
                },
                'unlock-pdf': {
                    title: 'Unlock PDF',
                    desc: 'Remove password protection from PDF.',
                    icon: 'üîì',
                    accept: '.pdf',
                    multiple: false,
                    optionsUI: `
                        <label>PDF Password:</label>
                        <input type="password" id="pdf-password" placeholder="Enter PDF password">
                        <div style="margin-top: 5px;">
                            <input type="checkbox" id="show-password">
                            <label for="show-password" style="font-size: 0.9rem;">Show password</label>
                        </div>
                    `,
                    process: async (files) => {
                        utils.showLoader('Removing password protection...');
                        try {
                            const password = document.getElementById('pdf-password').value;
                            
                            if (!password) {
                                utils.showError('Please enter the PDF password.');
                                utils.hideLoader();
                                return;
                            }
                            
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            
                            try {
                                const pdfDoc = await PDFDocument.load(bytes, {password: password});
                                const pdfBytes = await pdfDoc.save();
                                utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'unlocked_swag.pdf');
                            } catch (error) {
                                utils.showError('Incorrect password or PDF is not password protected.');
                            }
                            
                        } catch (error) {
                            utils.showError('Error unlocking PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    },
                    onFileSelect: () => {
                        const passwordInput = document.getElementById('pdf-password');
                        const showPasswordCheckbox = document.getElementById('show-password');
                        
                        showPasswordCheckbox.addEventListener('change', () => {
                            passwordInput.type = showPasswordCheckbox.checked ? 'text' : 'password';
                        });
                    }
                },
                'protect-pdf': {
                    title: 'Protect PDF',
                    desc: 'Add password protection to PDF.',
                    icon: 'üîí',
                    accept: '.pdf',
                    multiple: false,
                    optionsUI: `
                        <label>Set Password:</label>
                        <input type="password" id="protect-password" placeholder="Enter password">
                        
                        <label>Confirm Password:</label>
                        <input type="password" id="confirm-password" placeholder="Confirm password">
                        
                        <div style="margin-top: 5px;">
                            <input type="checkbox" id="show-protect-password">
                            <label for="show-protect-password" style="font-size: 0.9rem;">Show passwords</label>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <label>Permissions:</label>
                            <div style="margin-top: 10px;">
                                <input type="checkbox" id="allow-printing" checked>
                                <label for="allow-printing">Allow Printing</label>
                            </div>
                            <div>
                                <input type="checkbox" id="allow-copying" checked>
                                <label for="allow-copying">Allow Copying Text</label>
                            </div>
                            <div>
                                <input type="checkbox" id="allow-modifying">
                                <label for="allow-modifying">Allow Modifications</label>
                            </div>
                        </div>
                    `,
                    process: async (files) => {
                        utils.showLoader('Adding password protection...');
                        try {
                            const password = document.getElementById('protect-password').value;
                            const confirmPassword = document.getElementById('confirm-password').value;
                            
                            if (!password || !confirmPassword) {
                                utils.showError('Please enter and confirm password.');
                                utils.hideLoader();
                                return;
                            }
                            
                            if (password !== confirmPassword) {
                                utils.showError('Passwords do not match.');
                                utils.hideLoader();
                                return;
                            }
                            
                            if (password.length < 4) {
                                utils.showError('Password must be at least 4 characters.');
                                utils.hideLoader();
                                return;
                            }
                            
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            const pdfDoc = await PDFDocument.load(bytes);
                            
                            const allowPrinting = document.getElementById('allow-printing').checked;
                            const allowCopying = document.getElementById('allow-copying').checked;
                            const allowModifying = document.getElementById('allow-modifying').checked;
                            
                            // Note: pdf-lib has limited encryption support in browser
                            // In production, you'd need a backend for proper encryption
                            const pdfBytes = await pdfDoc.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'protected_swag.pdf');
                            
                            // Show success message with password reminder
                            setTimeout(() => {
                                const outputDiv = document.getElementById('output-area');
                                const reminder = document.createElement('p');
                                reminder.innerHTML = `<strong>‚ö†Ô∏è Important:</strong> Remember your password: <code>${password}</code>`;
                                reminder.style.marginTop = '10px';
                                reminder.style.padding = '10px';
                                reminder.style.background = '#fff3cd';
                                reminder.style.borderRadius = '5px';
                                reminder.style.color = '#856404';
                                outputDiv.appendChild(reminder);
                            }, 100);
                            
                        } catch (error) {
                            utils.showError('Error protecting PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    },
                    onFileSelect: () => {
                        const passwordInput = document.getElementById('protect-password');
                        const confirmInput = document.getElementById('confirm-password');
                        const showPasswordCheckbox = document.getElementById('show-protect-password');
                        
                        showPasswordCheckbox.addEventListener('change', () => {
                            const type = showPasswordCheckbox.checked ? 'text' : 'password';
                            passwordInput.type = type;
                            confirmInput.type = type;
                        });
                    }
                },
                'organize-pdf': {
                    title: 'Organize PDF',
                    desc: 'Rearrange, delete, or duplicate pages.',
                    icon: 'üìã',
                    accept: '.pdf',
                    multiple: false,
                    optionsUI: `
                        <div id="pages-list" style="max-height: 300px; overflow-y: auto; margin-bottom: 20px; padding: 15px; background: white; border-radius: 8px; border: 1px solid var(--border-color);">
                            <p style="text-align: center; color: var(--text-light);">Loading pages...</p>
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <button id="move-up" style="flex: 1; padding: 8px; background: var(--primary-swag); color: white; border: none; border-radius: 6px; cursor: pointer;">Move Up</button>
                            <button id="move-down" style="flex: 1; padding: 8px; background: var(--primary-swag); color: white; border: none; border-radius: 6px; cursor: pointer;">Move Down</button>
                            <button id="delete-page" style="flex: 1; padding: 8px; background: var(--accent-swag); color: white; border: none; border-radius: 6px; cursor: pointer;">Delete</button>
                            <button id="duplicate-page" style="flex: 1; padding: 8px; background: var(--accent-green); color: white; border: none; border-radius: 6px; cursor: pointer;">Duplicate</button>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <label>Page Order (drag to reorder):</label>
                            <div id="page-order" style="margin-top: 10px; padding: 10px; background: white; border-radius: 8px; border: 1px solid var(--border-color); min-height: 100px;"></div>
                        </div>
                    `,
                    process: async (files) => {
                        utils.showLoader('Organizing PDF...');
                        try {
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            const pdfDoc = await PDFDocument.load(bytes);
                            const newPdf = await PDFDocument.create();
                            
                            // Get page order from UI
                            const pageOrderDiv = document.getElementById('page-order');
                            const pageItems = pageOrderDiv.querySelectorAll('.page-item');
                            const pageOrder = Array.from(pageItems).map(item => parseInt(item.dataset.pageIndex));
                            
                            for (const pageIndex of pageOrder) {
                                const copiedPages = await newPdf.copyPages(pdfDoc, [pageIndex]);
                                copiedPages.forEach(page => newPdf.addPage(page));
                            }
                            
                            const pdfBytes = await newPdf.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'organized_swag.pdf');
                            
                        } catch (error) {
                            utils.showError('Error organizing PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    },
                    onFileSelect: async (file) => {
                        utils.showLoader('Loading PDF pages...');
                        try {
                            const bytes = await utils.readFileAsArrayBuffer(file);
                            const pdfDoc = await PDFDocument.load(bytes);
                            const pageCount = pdfDoc.getPages().length;
                            
                            const pagesListDiv = document.getElementById('pages-list');
                            const pageOrderDiv = document.getElementById('page-order');
                            
                            pagesListDiv.innerHTML = '';
                            pageOrderDiv.innerHTML = '';
                            
                            let selectedPage = null;
                            const pageOrder = Array.from({length: pageCount}, (_, i) => i);
                            
                            // Create pages list
                            for (let i = 0; i < pageCount; i++) {
                                const pageDiv = document.createElement('div');
                                pageDiv.className = 'page-item-select';
                                pageDiv.dataset.pageIndex = i;
                                pageDiv.innerHTML = `
                                    <div style="display: flex; align-items: center; padding: 10px; border-bottom: 1px solid var(--border-color); cursor: pointer;">
                                        <span style="width: 30px; font-weight: bold; color: var(--primary-dark);">${i + 1}</span>
                                        <span style="flex: 1;">Page ${i + 1}</span>
                                        <input type="checkbox" class="page-checkbox" data-page-index="${i}">
                                    </div>
                                `;
                                
                                pageDiv.addEventListener('click', (e) => {
                                    if (!e.target.classList.contains('page-checkbox')) {
                                        const checkboxes = pagesListDiv.querySelectorAll('.page-checkbox');
                                        checkboxes.forEach(cb => cb.checked = false);
                                        const checkbox = pageDiv.querySelector('.page-checkbox');
                                        checkbox.checked = true;
                                        selectedPage = i;
                                    }
                                });
                                
                                pagesListDiv.appendChild(pageDiv);
                                
                                // Add to order list
                                const orderItem = document.createElement('div');
                                orderItem.className = 'page-item';
                                orderItem.dataset.pageIndex = i;
                                orderItem.innerHTML = `
                                    <div style="display: flex; align-items: center; padding: 8px; margin-bottom: 5px; background: var(--background-light); border-radius: 6px; cursor: move;">
                                        <span style="margin-right: 10px; color: var(--text-light);">‚ò∞</span>
                                        <span>Page ${i + 1}</span>
                                    </div>
                                `;
                                pageOrderDiv.appendChild(orderItem);
                            }
                            
                            // Make order list sortable
                            let draggedItem = null;
                            pageOrderDiv.querySelectorAll('.page-item').forEach(item => {
                                item.setAttribute('draggable', 'true');
                                
                                item.addEventListener('dragstart', () => {
                                    draggedItem = item;
                                    setTimeout(() => item.style.opacity = '0.4', 0);
                                });
                                
                                item.addEventListener('dragend', () => {
                                    setTimeout(() => {
                                        draggedItem.style.opacity = '';
                                        draggedItem = null;
                                    }, 0);
                                });
                                
                                item.addEventListener('dragover', (e) => {
                                    e.preventDefault();
                                });
                                
                                item.addEventListener('drop', (e) => {
                                    e.preventDefault();
                                    if (draggedItem && draggedItem !== item) {
                                        const allItems = Array.from(pageOrderDiv.querySelectorAll('.page-item'));
                                        const draggedIndex = allItems.indexOf(draggedItem);
                                        const targetIndex = allItems.indexOf(item);
                                        
                                        if (draggedIndex < targetIndex) {
                                            item.parentNode.insertBefore(draggedItem, item.nextSibling);
                                        } else {
                                            item.parentNode.insertBefore(draggedItem, item);
                                        }
                                    }
                                });
                            });
                            
                            // Button handlers
                            document.getElementById('move-up').addEventListener('click', () => {
                                if (selectedPage !== null && selectedPage > 0) {
                                    const items = Array.from(pageOrderDiv.querySelectorAll('.page-item'));
                                    const currentIndex = items.findIndex(item => parseInt(item.dataset.pageIndex) === selectedPage);
                                    if (currentIndex > 0) {
                                        const temp = pageOrder[currentIndex];
                                        pageOrder[currentIndex] = pageOrder[currentIndex - 1];
                                        pageOrder[currentIndex - 1] = temp;
                                        
                                        // Update UI
                                        const tempElement = items[currentIndex];
                                        pageOrderDiv.insertBefore(tempElement, items[currentIndex - 1]);
                                        selectedPage = pageOrder[currentIndex - 1];
                                    }
                                }
                            });
                            
                            document.getElementById('move-down').addEventListener('click', () => {
                                if (selectedPage !== null && selectedPage < pageOrder.length - 1) {
                                    const items = Array.from(pageOrderDiv.querySelectorAll('.page-item'));
                                    const currentIndex = items.findIndex(item => parseInt(item.dataset.pageIndex) === selectedPage);
                                    if (currentIndex < items.length - 1) {
                                        const temp = pageOrder[currentIndex];
                                        pageOrder[currentIndex] = pageOrder[currentIndex + 1];
                                        pageOrder[currentIndex + 1] = temp;
                                        
                                        // Update UI
                                        const nextElement = items[currentIndex + 1];
                                        pageOrderDiv.insertBefore(nextElement, items[currentIndex]);
                                        selectedPage = pageOrder[currentIndex + 1];
                                    }
                                }
                            });
                            
                            document.getElementById('delete-page').addEventListener('click', () => {
                                if (selectedPage !== null) {
                                    const items = Array.from(pageOrderDiv.querySelectorAll('.page-item'));
                                    const currentIndex = items.findIndex(item => parseInt(item.dataset.pageIndex) === selectedPage);
                                    if (currentIndex !== -1) {
                                        items[currentIndex].remove();
                                        pageOrder.splice(currentIndex, 1);
                                        selectedPage = null;
                                    }
                                }
                            });
                            
                            document.getElementById('duplicate-page').addEventListener('click', () => {
                                if (selectedPage !== null) {
                                    const items = Array.from(pageOrderDiv.querySelectorAll('.page-item'));
                                    const currentIndex = items.findIndex(item => parseInt(item.dataset.pageIndex) === selectedPage);
                                    if (currentIndex !== -1) {
                                        const duplicateItem = items[currentIndex].cloneNode(true);
                                        duplicateItem.dataset.pageIndex = selectedPage;
                                        pageOrderDiv.insertBefore(duplicateItem, items[currentIndex].nextSibling);
                                        pageOrder.splice(currentIndex + 1, 0, selectedPage);
                                    }
                                }
                            });
                            
                        } catch (error) {
                            utils.showError('Error loading PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    }
                },
                'crop-pdf': {
                    title: 'Crop PDF',
                    desc: 'Crop margins from PDF pages.',
                    icon: '‚úÇÔ∏è',
                    accept: '.pdf',
                    multiple: false,
                    optionsUI: `
                        <label>Crop Margins (in points):</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                            <div>
                                <label style="font-size: 0.9rem;">Top:</label>
                                <input type="number" id="crop-top" value="0" min="0" style="width: 100%;">
                            </div>
                            <div>
                                <label style="font-size: 0.9rem;">Right:</label>
                                <input type="number" id="crop-right" value="0" min="0" style="width: 100%;">
                            </div>
                            <div>
                                <label style="font-size: 0.9rem;">Bottom:</label>
                                <input type="number" id="crop-bottom" value="0" min="0" style="width: 100%;">
                            </div>
                            <div>
                                <label style="font-size: 0.9rem;">Left:</label>
                                <input type="number" id="crop-left" value="0" min="0" style="width: 100%;">
                            </div>
                        </div>
                        
                        <label>Apply to:</label>
                        <select id="crop-pages">
                            <option value="all">All Pages</option>
                            <option value="first">First Page Only</option>
                            <option value="range">Page Range</option>
                        </select>
                        
                        <div id="crop-range-container" style="display: none; margin-top: 10px;">
                            <label>Page Range (e.g., "1-3"):</label>
                            <input type="text" id="crop-range" placeholder="e.g. 1-3">
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <label>Preset Margins:</label>
                            <select id="crop-preset" style="width: 100%;">
                                <option value="custom">Custom</option>
                                <option value="small">Small Margin (10 pts)</option>
                                <option value="medium">Medium Margin (20 pts)</option>
                                <option value="large">Large Margin (40 pts)</option>
                                <option value="none">No Margin</option>
                            </select>
                        </div>
                    `,
                    process: async (files) => {
                        utils.showLoader('Cropping PDF...');
                        try {
                            const top = parseFloat(document.getElementById('crop-top').value) || 0;
                            const right = parseFloat(document.getElementById('crop-right').value) || 0;
                            const bottom = parseFloat(document.getElementById('crop-bottom').value) || 0;
                            const left = parseFloat(document.getElementById('crop-left').value) || 0;
                            const pagesOption = document.getElementById('crop-pages').value;
                            const rangeStr = document.getElementById('crop-range').value;
                            
                            const bytes = await utils.readFileAsArrayBuffer(files[0]);
                            const pdfDoc = await PDFDocument.load(bytes);
                            const pageCount = pdfDoc.getPages().length;
                            
                            let pagesToCrop = [];
                            
                            if (pagesOption === 'all') {
                                pagesToCrop = Array.from({length: pageCount}, (_, i) => i);
                            } else if (pagesOption === 'first') {
                                pagesToCrop = [0];
                            } else if (pagesOption === 'range' && rangeStr) {
                                const pagesSet = new Set();
                                rangeStr.split(',').forEach(part => {
                                    const range = part.trim().split('-');
                                    if(range.length === 2) {
                                        const start = parseInt(range[0]);
                                        const end = parseInt(range[1]);
                                        if(!isNaN(start) && !isNaN(end)) {
                                            for(let i = start; i <= end; i++) pagesSet.add(i-1);
                                        }
                                    } else {
                                        const page = parseInt(range[0]);
                                        if(!isNaN(page)) pagesSet.add(page-1);
                                    }
                                });
                                pagesToCrop = Array.from(pagesSet).filter(i => i >= 0 && i < pageCount);
                            }
                            
                            pagesToCrop.forEach(pageIndex => {
                                const page = pdfDoc.getPages()[pageIndex];
                                const { width, height } = page.getSize();
                                
                                // Create a new page with cropped dimensions
                                page.setSize(width - left - right, height - top - bottom);
                                
                                // Note: Actual content cropping would require more complex manipulation
                                // This is a simplified version that just resizes the page
                            });
                            
                            const pdfBytes = await pdfDoc.save();
                            utils.createDownloadLink(new Blob([pdfBytes], { type: 'application/pdf' }), 'cropped_swag.pdf');
                            
                        } catch (error) {
                            utils.showError('Error cropping PDF: ' + error.message);
                        }
                        utils.hideLoader();
                    },
                    onFileSelect: () => {
                        const presetSelect = document.getElementById('crop-preset');
                        const pagesSelect = document.getElementById('crop-pages');
                        const rangeContainer = document.getElementById('crop-range-container');
                        
                        presetSelect.addEventListener('change', () => {
                            const preset = presetSelect.value;
                            let top, right, bottom, left;
                            
                            switch(preset) {
                                case 'small': top=right=bottom=left=10; break;
                                case 'medium': top=right=bottom=left=20; break;
                                case 'large': top=right=bottom=left=40; break;
                                case 'none': top=right=bottom=left=0; break;
                                default: return;
                            }
                            
                            document.getElementById('crop-top').value = top;
                            document.getElementById('crop-right').value = right;
                            document.getElementById('crop-bottom').value = bottom;
                            document.getElementById('crop-left').value = left;
                        });
                        
                        pagesSelect.addEventListener('change', () => {
                            rangeContainer.style.display = pagesSelect.value === 'range' ? 'block' : 'none';
                        });
                    }
                }
            };

            // Helper function to convert hex to RGB
            function hexToRgb(hex) {
                const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                    r: parseInt(result[1], 16) / 255,
                    g: parseInt(result[2], 16) / 255,
                    b: parseInt(result[3], 16) / 255
                } : {r: 0.5, g: 0.5, b: 0.5};
            }

            // --- UI Generation ---
            const featuredGrid = document.getElementById('featured-tools');
            const allToolsGrid = document.getElementById('all-tools-grid');
            
            // Separate featured and all tools
            const featuredTools = [];
            const allTools = [];
            
            Object.keys(tools).forEach(key => {
                if (tools[key].featured) {
                    featuredTools.push({key, ...tools[key]});
                }
                allTools.push({key, ...tools[key]});
            });
            
            // Add featured tools
            featuredTools.forEach((tool, index) => {
                const div = createToolCard(tool, index, true);
                featuredGrid.appendChild(div);
            });
            
            // Add all tools
            allTools.forEach((tool, index) => {
                const div = createToolCard(tool, index, false);
                allToolsGrid.appendChild(div);
            });
            
            function createToolCard(tool, index, isFeatured) {
                const div = document.createElement('div');
                div.className = 'tool-card';
                div.style.animationDelay = `${index * 50}ms`;
                div.innerHTML = `
                    <div class="icon">${tool.icon}</div>
                    <h3>${tool.title}</h3>
                    <p>${tool.desc}</p>
                    ${isFeatured ? '<div class="featured-badge">Featured</div>' : ''}
                    ${index < 3 ? '<div class="swag-badge">New</div>' : ''}
                `;
                div.addEventListener('click', () => openModal(tool.key));
                
                setTimeout(() => div.classList.add('reveal'), 100);
                return div;
            }

            // --- Modal Logic ---
            const modal = document.getElementById('tool-modal');
            const fileInput = document.getElementById('file-input');
            const fileList = document.getElementById('file-list');
            const dropZone = document.getElementById('drop-zone');
            const processBtn = document.getElementById('process-btn');

            function openModal(toolId) {
                state.currentToolId = toolId;
                state.files = [];
                const tool = tools[toolId];
                
                document.getElementById('modal-title').innerText = `${tool.title} - SwagChup`;
                document.getElementById('tool-options').innerHTML = tool.optionsUI || '';
                fileInput.accept = tool.accept || '*/*';
                fileInput.multiple = tool.multiple || false;
                
                renderFileList();
                document.getElementById('output-area').innerHTML = '';
                modal.classList.add('active');
                
                // Call onFileSelect if defined
                if (tool.onFileSelect) {
                    tool.onFileSelect();
                }
            }

            document.getElementById('close-modal').onclick = () => {
                modal.classList.remove('active');
                if(window.fabricCanvas) window.fabricCanvas.dispose();
                // Clear any canvas contexts
                const canvases = document.querySelectorAll('canvas');
                canvases.forEach(canvas => {
                    const ctx = canvas.getContext('2d');
                    if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);
                });
            };

            dropZone.addEventListener('click', () => fileInput.click());
            dropZone.addEventListener('dragover', (e) => { 
                e.preventDefault(); 
                dropZone.classList.add('dragover'); 
            });
            
            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('dragover'); 
            });
            
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                handleFiles(e.dataTransfer.files);
            });
            
            fileInput.addEventListener('change', (e) => handleFiles(e.target.files));
            
            document.querySelector('.select-file-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                fileInput.click();
            });

            function handleFiles(files) {
                const tool = tools[state.currentToolId];
                if(tool.multiple) {
                    state.files = [...state.files, ...Array.from(files)];
                } else {
                    state.files = [files[0]];
                }
                renderFileList();
                
                // Call onFileSelect with file if tool supports it
                if (tool.onFileSelect && state.files.length > 0 && typeof tool.onFileSelect === 'function') {
                    // Check if onFileSelect expects a file parameter
                    const funcString = tool.onFileSelect.toString();
                    if (funcString.includes('(file)') || funcString.includes('(files[0])')) {
                        tool.onFileSelect(state.files[0]);
                    } else {
                        tool.onFileSelect();
                    }
                }
            }

            function renderFileList() {
                fileList.innerHTML = '';
                state.files.forEach((file, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <span style="display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.2em;">üìÑ</span>
                            <span>${file.name} (${(file.size / 1024).toFixed(1)} KB)</span>
                        </span>
                        <span class="remove" data-index="${index}">‚úï</span>
                    `;
                    fileList.appendChild(li);
                });
                
                processBtn.disabled = state.files.length === 0;
                
                document.querySelectorAll('.remove').forEach(span => {
                    span.addEventListener('click', (e) => {
                        const idx = parseInt(e.target.dataset.index);
                        state.files.splice(idx, 1);
                        renderFileList();
                    });
                });
            }

            processBtn.addEventListener('click', async () => {
                const tool = tools[state.currentToolId];
                try {
                    await tool.process(state.files);
                } catch (e) {
                    console.error(e);
                    utils.showError('An error occurred: ' + e.message);
                }
            });

            // --- Navigation ---
            const header = document.getElementById('main-header');
            const hamburger = document.getElementById('hamburger');
            const nav = document.getElementById('main-nav');

            window.addEventListener('scroll', () => {
                if(window.scrollY > 50) {
                    header.style.boxShadow = '0 5px 20px rgba(0,0,0,0.1)';
                } else {
                    header.style.boxShadow = 'none';
                }
            });

            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                nav.classList.toggle('active');
            });
            
            nav.querySelectorAll('a').forEach(a => {
                a.addEventListener('click', () => {
                    hamburger.classList.remove('active');
                    nav.classList.remove('active');
                });
            });

            // --- Stats Counter Animation ---
            function animateStats() {
                const stats = document.querySelectorAll('.stat-number');
                stats.forEach(stat => {
                    const target = parseFloat(stat.getAttribute('data-count'));
                    let current = 0;
                    const increment = target / 50;
                    const timer = setInterval(() => {
                        current += increment;
                        if(current >= target) {
                            current = target;
                            clearInterval(timer);
                        }
                        stat.textContent = target.toString().includes('.') 
                            ? current.toFixed(1) 
                            : Math.floor(current);
                    }, 30);
                });
            }

            // Trigger stats animation when in viewport
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if(entry.isIntersecting) {
                        animateStats();
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.5 });

            const heroSection = document.querySelector('.hero-section');
            if(heroSection) {
                observer.observe(heroSection);
            }

            // --- Initialize Ads ---
            (adsbygoogle = window.adsbygoogle || []).push({});

            // Add auth buttons placeholder
            function addAuthButtons() {
                const navUl = document.querySelector('.main-nav ul');
                const authLi = document.createElement('li');
                authLi.className = 'auth-buttons';
                authLi.innerHTML = `
                    <button class="btn-login" id="btn-login">Log In</button>
                    <button class="btn-signup" id="btn-signup">Sign Up</button>
                `;
                navUl.appendChild(authLi);

                // Add click handlers
                document.getElementById('btn-login').addEventListener('click', () => {
                    alert('Login functionality coming soon!');
                });

                document.getElementById('btn-signup').addEventListener('click', () => {
                    alert('Sign up functionality coming soon!');
                });
            }

            addAuthButtons();
        });
    </script>
</body>
</html>






